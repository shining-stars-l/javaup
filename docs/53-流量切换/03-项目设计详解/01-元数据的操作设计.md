---
slug: /link-flow/design/metadata-design
---

import PaidCTA from '@site/src/components/PaidCTA';

# 元数据的操作设计

在介绍 link-flow 的使用时，涉及到了 区域、组、版本，并根据将配置中的信息，放到了服务的元数据中。
配置信息：

```yaml
spring:
  application:
    name: consumer-service
  cloud:
    link-flow:
      metadata:
        group: test-group
        version: 1.0
        zone: test-zone-1
```

注册中心以 Nacos 为例，查看服务中的元数据：
![](/img/link-flow/元数据的操作设计/nacos元数据.png)

这就需要设计对服务元数据的操作了，而Nacos和Eureka的操作是不同的，就需要将两者进行适配，这就需要进行分层次的设计，希望小伙伴理解完后，自己在设计项目时，会掌握这种设计思想。

# 接口 MetaDataOperation 的设计
既然是要兼容 Nacos 和 Eureka，那么肯定首先要将元数据操作的行为先设计好接口，叫 MetaDataOperation
```java
public interface MetaDataOperation {
    /**
     * 规则
     * @return 结果
     * */
    ConfigRule getConfigRule();
    
    /**
     * 获取服务id
     * @param server 服务
     * @return 结果
     * */
    String getServiceIdFromServer(ServiceInstance server);
    
    /**
     * 获取版本
     * @param server 服务
     * @return 结果
     * */
    String getVersionFromServer(ServiceInstance server);
    
    /**
     * 获取版本
     * @return 结果
     * */
    String getVersion();
    
    /**
     * 获取区域
     * @return 结果
     * */
    String getZone();
    
    /**
     * 获取灰度
     * @return 结果
     * */
    String getGray();
    
    /**
     * 获取区域
     * @param server 服务
     * @return 结果
     * */
    String getZoneFromServer(ServiceInstance server);
    
    /**
     * 获取灰度
     * @param server 服务
     * @return 结果
     * */
    String getGrayFromServer(ServiceInstance server);
    
    /**
     * 获取组
     * @return 结果
     * */
    String getDefaultGroupKey();

    /**
     * 获取组
     * @return 结果
     * */
    String getGroup();
    
    /**
     * 获取服务id
     * @return 结果
     * */
    String getServiceId();
    
    /**
     * 规则
     * @param configRule 规则
     * */
    void setRule(ConfigRule configRule);
    
    /**
     * 获取组
     * @param server 服务
     * @return 结果
     * */
    String getGroupFromServer(ServiceInstance server);
    
    /**
     * 获取信息
     * @return 结果
     * */
    Map<String,String> getInfo();
}
```


<PaidCTA />