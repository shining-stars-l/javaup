---
slug: /link-flow/design/config-center-design
---

import PaidCTA from '@site/src/components/PaidCTA';

# 配置中心的操作设计

在介绍 link-flow 项目时，提到了路由参数可以通过请求头传递规则，也可以通过配置中心来配置规则，而且配置中心修改更为灵活。

link-flow 支持的配置中心有 Nacos 和 Apollo，而 Nacos 和 Apollo 的操作是不同的，就需要将两者进行适配，这和元数据操作设计很相似，也需要分层次的设计。
RemoteConfigRuleOperation

既然是要兼容 Nacos 和 Apollo，那么肯定首先要将配置中心操作的行为先设计好接口，叫 RemoteConfigRuleOperation
```java
public interface RemoteConfigRuleOperation {
    
    /**
     * 监听配置
     * */
    void listenConfig();
    
    /**
     * 得到配置
     * @param generalConfig 配置标识
     * @return 结果
     * @throws Exception 异常
     * */
    String getConfig(boolean generalConfig) throws Exception;
}
```

接口是为了表示具有这些行为，对如果是具体实现的话，就再认真考虑了，虽然是要适配 Nacos 和 Apollo 两个注册中心，要肯定有些操作不一样，而有些操作是一样的，就拿获取读取配置来说，这两个配置中心都要先获取到dataId和group，而这两个是从元数据中读取，元数据已经是接口操作了，所以就可以理解成是相同的操作。

而拿到 dataId 和 group 后再从具提的 Nacos 和 Apollo 获取配置的操作肯定是不一样的。

# AbstractRemoteConfigRuleOperation
所以对这种有的操作相同，有的操作又不相同的逻辑就会用到一种设计模式 模版模式 。而此模式最重要的就是要有个抽象类，将公共逻辑抽象出来，不同的逻辑要由各自实现类去实现。

<PaidCTA />