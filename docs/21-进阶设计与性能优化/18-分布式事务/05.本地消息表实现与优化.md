---
slug: /architecture/distributed-transaction/local-message-table
description: "本地消息表设计原理与业务操作原子性保证;定时任务补偶与消息状态机设计;消息重试策略与死信队列处理;消息表清理与归档优化实践。"
keywords: ["本地消息表", "消息补偶", "定时任务", "消息状态机", "分布式事务"]
sidebar_class_name: has-paid-badge
---

import PaidCTA from '@site/src/components/PaidCTA';

# 本地消息表实现与优化

## 本地消息表方案原理

本地消息表是一种通过在本地数据库创建消息表来保证消息可靠投递的分布式事务解决方案。该方案的核心思想是将分布式事务拆分为本地事务和消息事务两个部分，通过本地事务保证业务数据和消息记录的原子性，再通过定时任务或事件机制保证消息最终能够成功发送并被消费。

### 核心设计思想

本地消息表方案的关键在于：**将业务操作和消息记录放在同一个本地事务中**。这样可以利用数据库的ACID特性，确保只要业务操作成功，本地消息记录就一定能够成功写入。

基本流程如下：

<PaidCTA />