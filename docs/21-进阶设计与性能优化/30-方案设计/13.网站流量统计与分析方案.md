---
slug: /architecture/solution-design/traffic-statistics
description: "PV页面浏览/UV独立访客/VV访问次数核心指标;UV统计HyperLogLog算法应用;埋点采集与Kafka实时消费流程;维度拆分与报表展示方案设计。"
keywords: ["流量统计", "PV", "UV", "HyperLogLog", "埋点分析"]
sidebar_class_name: has-paid-badge
---

import PaidCTA from '@site/src/components/PaidCTA';

# 网站流量统计与分析方案

## 流量指标体系

在分析网站或应用的活跃度时，有几个核心指标需要掌握：

### 核心指标定义

```mermaid
graph TD
    A["流量统计指标"] --> B["PV - 页面浏览量"]
    A --> C["UV - 独立访客数"]
    A --> D["VV - 访问次数"]
    A --> E["IP - 独立IP数"]
    
    B --> B1["每次页面加载计数一次"]
    C --> C1["同一访客一天只计一次"]
    D --> D1["一次完整访问计数一次"]
    E --> E1["不同IP地址计数"]
    
    style A fill:#4A90E2,color:#fff,rx:10,ry:10
    style B fill:#E74C3C,color:#fff,rx:10,ry:10
    style C fill:#27AE60,color:#fff,rx:10,ry:10
    style D fill:#9B59B6,color:#fff,rx:10,ry:10
    style E fill:#E67E22,color:#fff,rx:10,ry:10
```

**举例说明**：

假设用户通过家庭宽带上网，早上访问了电商平台的2个商品页面，下午又访问了3个商品页面：

| 指标 | 计算方式 | 结果 |
|------|---------|------|
| PV | 早上2页 + 下午3页 | 5 |
| UV | 同一访客全天只计1次 | 1 |
| VV | 早上1次 + 下午1次访问 | 2 |
| IP | 宽带可能换IP | 1-2 |

### 指标的业务价值

- **PV**：反映网站内容的吸引力和用户浏览深度
- **UV**：反映真实的用户覆盖面
- **PV/UV比值**：反映用户粘性，比值越高说明单用户浏览越多
- **IP**：用于判断用户地域分布和识别异常流量

## UV统计技术方案

### 方案一：Set集合精确统计

最直观的实现方式是为每个页面维护一个用户ID集合：

```mermaid
graph TD
    A["用户访问页面"] --> B["获取用户标识"]
    B --> C{"Set中是否存在"}
    C -->|是| D["不做处理"]
    C -->|否| E["添加到Set"]
    
    F["统计UV"] --> G["计算Set大小"]
    
    style A fill:#4A90E2,color:#fff,rx:10,ry:10
    style E fill:#27AE60,color:#fff,rx:10,ry:10
    style G fill:#9B59B6,color:#fff,rx:10,ry:10
```

**Redis Set实现**：

<PaidCTA />