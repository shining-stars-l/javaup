---
slug: /hmdp-plus/ops-consistency/stock-dual-consistency
---

import PaidCTA from '@site/src/components/PaidCTA';

# 库存修改的双轨一致性

:::info plus 版本专属
此章节是黑马点评 Plus 版本中专有的内容，而在整套文档中将普通版本和 Plus 版本都融合在了一起，让大家更方便的学习。
:::

当优惠券过于受到用户的欢迎，导致优惠券一瞬间就会抢购一空，这时可以根据店铺的业务情况来适当的增加优惠券的库存，来吸引更多的用户。

而此章节将会讲解如何修改优惠券的库存，并且是支持在高并发下用户抢购的同时进行修改的

### 方法目标
+ 根据传入的“新的初始库存”调整券的实际可售库存与初始库存，确保数据库与 Redis 同步；
+ 防止库存变为负数；
+ 在库存增加时，异步尝试将资格发给订阅队列中最早的未购用户

<PaidCTA />