---
slug: /java/collect/hashmap-traversal-best-practices
---

## HashMapéå†æ–¹å¼å…¨è§£æ

è‡ªJDK 1.8å¼•å…¥Stream APIå,HashMapçš„éå†æ–¹å¼å˜å¾—æ›´åŠ å¤šæ ·åŒ–ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æHashMapçš„å„ç§éå†æ–¹å¼,å¹¶ä»æ€§èƒ½ã€åŸç†å’Œå®‰å…¨æ€§ç­‰å¤šä¸ªç»´åº¦è¿›è¡Œå¯¹æ¯”åˆ†æ,å¸®åŠ©å¼€å‘è€…é€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆã€‚

### éå†æ–¹å¼åˆ†ç±»

HashMapçš„éå†æ–¹å¼å¯ä»¥åˆ†ä¸º4å¤§ç±»ã€7ç§å…·ä½“å®ç°:

```mermaid
graph TB
    A[HashMapéå†æ–¹å¼] --> B[è¿­ä»£å™¨æ–¹å¼]
    A --> C[For-Eachæ–¹å¼]
    A --> D[Lambdaè¡¨è¾¾å¼ JDK 1.8+]
    A --> E[Stream API JDK 1.8+]
    
    B --> B1[Iterator EntrySet]
    B --> B2[Iterator KeySet]
    
    C --> C1[ForEach EntrySet]
    C --> C2[ForEach KeySet]
    
    E --> E1[å•çº¿ç¨‹Stream]
    E --> E2[å¹¶è¡ŒStream]
    
    style A fill:#4A90E2,color:#fff,rx:10,ry:10
    style B fill:#50E3C2,color:#fff,rx:10,ry:10
    style C fill:#50E3C2,color:#fff,rx:10,ry:10
    style D fill:#9013FE,color:#fff,rx:10,ry:10
    style E fill:#E94B3C,color:#fff,rx:10,ry:10
```

## ä¸ƒç§éå†æ–¹å¼è¯¦è§£

### æ–¹å¼ä¸€: è¿­ä»£å™¨EntrySetéå†

EntrySetæ–¹å¼ä¸€æ¬¡æ€§è·å–é”®å€¼å¯¹,æ— éœ€é¢å¤–æŸ¥è¯¢:

```java
public class ProductInventory {
    public static void main(String[] args) {
        // å•†å“åº“å­˜ç®¡ç†ç³»ç»Ÿ
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // ä½¿ç”¨è¿­ä»£å™¨EntrySetéå†
        Iterator<Map.Entry<String, Integer>> iterator = inventory.entrySet().iterator();
        while (iterator.hasNext()) {
            Map.Entry<String, Integer> entry = iterator.next();
            System.out.println("å•†å“: " + entry.getKey() + ", åº“å­˜: " + entry.getValue());
        }
    }
}
```

### æ–¹å¼äºŒ: è¿­ä»£å™¨KeySetéå†

KeySetæ–¹å¼éœ€è¦é€šè¿‡keyäºŒæ¬¡æŸ¥è¯¢è·å–value:

```java
public class ProductInventory {
    public static void main(String[] args) {
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // ä½¿ç”¨è¿­ä»£å™¨KeySetéå†
        Iterator<String> iterator = inventory.keySet().iterator();
        while (iterator.hasNext()) {
            String product = iterator.next();
            Integer stock = inventory.get(product);  // éœ€è¦äºŒæ¬¡æŸ¥è¯¢
            System.out.println("å•†å“: " + product + ", åº“å­˜: " + stock);
        }
    }
}
```

### æ–¹å¼ä¸‰: ForEach EntrySetéå†

å¢å¼ºforå¾ªç¯çš„EntrySetæ–¹å¼,ä»£ç ç®€æ´:

```java
public class ProductInventory {
    public static void main(String[] args) {
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // å¢å¼ºforå¾ªç¯éå†EntrySet
        for (Map.Entry<String, Integer> entry : inventory.entrySet()) {
            System.out.println("å•†å“: " + entry.getKey() + ", åº“å­˜: " + entry.getValue());
        }
    }
}
```

### æ–¹å¼å››: ForEach KeySetéå†

å¢å¼ºforå¾ªç¯çš„KeySetæ–¹å¼:

```java
public class ProductInventory {
    public static void main(String[] args) {
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // å¢å¼ºforå¾ªç¯éå†KeySet
        for (String product : inventory.keySet()) {
            Integer stock = inventory.get(product);
            System.out.println("å•†å“: " + product + ", åº“å­˜: " + stock);
        }
    }
}
```

### æ–¹å¼äº”: Lambdaè¡¨è¾¾å¼éå†

JDK 1.8å¼•å…¥çš„Lambdaæ–¹å¼,ä»£ç æœ€ç®€æ´:

```java
public class ProductInventory {
    public static void main(String[] args) {
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // Lambdaè¡¨è¾¾å¼éå†
        inventory.forEach((product, stock) -> {
            System.out.println("å•†å“: " + product + ", åº“å­˜: " + stock);
        });
    }
}
```

### æ–¹å¼å…­: Stream APIå•çº¿ç¨‹éå†

Streamæä¾›å£°æ˜å¼ç¼–ç¨‹é£æ ¼:

```java
public class ProductInventory {
    public static void main(String[] args) {
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // Streamå•çº¿ç¨‹éå†
        inventory.entrySet().stream().forEach(entry -> {
            System.out.println("å•†å“: " + entry.getKey() + ", åº“å­˜: " + entry.getValue());
        });
    }
}
```

### æ–¹å¼ä¸ƒ: Stream APIå¹¶è¡Œéå†

åˆ©ç”¨å¤šæ ¸CPUå¹¶è¡Œå¤„ç†,é€‚åˆå¤§æ•°æ®é‡åœºæ™¯:

```java
public class ProductInventory {
    public static void main(String[] args) {
        Map<String, Integer> inventory = new HashMap<>();
        inventory.put("iPhone-15", 120);
        inventory.put("MacBook-Pro", 85);
        inventory.put("AirPods-Pro", 200);
        inventory.put("iPad-Air", 150);
        inventory.put("Apple-Watch", 95);
        
        // å¹¶è¡ŒStreaméå†(è¾“å‡ºé¡ºåºä¸å›ºå®š)
        inventory.entrySet().parallelStream().forEach(entry -> {
            System.out.println("å•†å“: " + entry.getKey() + ", åº“å­˜: " + entry.getValue());
        });
    }
}
```

## æ€§èƒ½åŸºå‡†æµ‹è¯•

### æµ‹è¯•ç¯å¢ƒæ­å»º

ä½¿ç”¨JMH(Java Microbenchmark Harness)è¿›è¡Œç²¾ç¡®çš„æ€§èƒ½æµ‹è¯•:

```xml
<!-- pom.xmlé…ç½® -->
<dependency>
    <groupId>org.openjdk.jmh</groupId>
    <artifactId>jmh-core</artifactId>
    <version>1.23</version>
</dependency>
<dependency>
    <groupId>org.openjdk.jmh</groupId>
    <artifactId>jmh-generator-annprocess</artifactId>
    <version>1.23</version>
    <scope>provided</scope>
</dependency>
```

### å®Œæ•´æµ‹è¯•ä»£ç 

```java
@BenchmarkMode(Mode.AverageTime)  // æµ‹è¯•å¹³å‡æ‰§è¡Œæ—¶é—´
@OutputTimeUnit(TimeUnit.NANOSECONDS)
@Warmup(iterations = 2, time = 1, timeUnit = TimeUnit.SECONDS)  // é¢„çƒ­2è½®
@Measurement(iterations = 5, time = 1, timeUnit = TimeUnit.SECONDS)  // æµ‹è¯•5è½®
@Fork(1)  // fork 1ä¸ªè¿›ç¨‹
@State(Scope.Thread)
public class HashMapTraversalBenchmark {
    
    static Map<Integer, String> productMap = new HashMap() {{
        for (int i = 0; i < 100; i++) {
            put(i, "product-" + i);
        }
    }};

    public static void main(String[] args) throws RunnerException {
        Options opt = new OptionsBuilder()
                .include(HashMapTraversalBenchmark.class.getSimpleName())
                .output("benchmark-results.log")
                .build();
        new Runner(opt).run();
    }

    @Benchmark
    public void iteratorEntrySet() {
        Iterator<Map.Entry<Integer, String>> iterator = productMap.entrySet().iterator();
        while (iterator.hasNext()) {
            Map.Entry<Integer, String> entry = iterator.next();
            Integer k = entry.getKey();
            String v = entry.getValue();
        }
    }

    @Benchmark
    public void forEachEntrySet() {
        for (Map.Entry<Integer, String> entry : productMap.entrySet()) {
            Integer k = entry.getKey();
            String v = entry.getValue();
        }
    }

    @Benchmark
    public void iteratorKeySet() {
        Iterator<Integer> iterator = productMap.keySet().iterator();
        while (iterator.hasNext()) {
            Integer k = iterator.next();
            String v = productMap.get(k);
        }
    }

    @Benchmark
    public void forEachKeySet() {
        for (Integer key : productMap.keySet()) {
            String v = productMap.get(key);
        }
    }

    @Benchmark
    public void lambdaForEach() {
        productMap.forEach((key, value) -> {
            Integer k = key;
            String v = value;
        });
    }

    @Benchmark
    public void streamApi() {
        productMap.entrySet().stream().forEach(entry -> {
            Integer k = entry.getKey();
            String v = entry.getValue();
        });
    }
}
```

### æ€§èƒ½æµ‹è¯•ç»“æœ

| éå†æ–¹å¼ | å¹³å‡è€—æ—¶(ns/op) | æ€§èƒ½æ’å |
|---------|----------------|---------|
| iteratorEntrySet | 2847.3 Â± 24.5 | ğŸ¥‡ ç¬¬1å |
| forEachEntrySet | 2908.1 Â± 31.2 | ğŸ¥ˆ ç¬¬2å |
| lambdaForEach | 3142.7 Â± 28.9 | ğŸ¥‰ ç¬¬3å |
| streamApi | 3789.5 Â± 42.1 | ç¬¬4å |
| iteratorKeySet | 5240.8 Â± 51.3 | ç¬¬5å |
| forEachKeySet | 5398.2 Â± 48.7 | ç¬¬6å |

**å…³é”®å‘ç°:**

1. **EntrySetæ€§èƒ½ä¼˜äºKeySetçº¦1.8å€** - KeySetéœ€è¦äºŒæ¬¡æŸ¥è¯¢
2. **Iteratorå’ŒForEachæ€§èƒ½æ¥è¿‘** - ç¼–è¯‘åå­—èŠ‚ç ç›¸åŒ
3. **Lambdaæ€§èƒ½ç•¥ä½äºForEach** - é¢å¤–çš„å‡½æ•°å¼æ¥å£å¼€é”€
4. **Streamæ€§èƒ½ä»‹äºä¸¤è€…ä¹‹é—´** - åŒ…è£…æµçš„åˆ›å»ºæœ‰å¼€é”€

## å­—èŠ‚ç æ·±åº¦åˆ†æ

### ç¼–è¯‘åä»£ç å¯¹æ¯”

é€šè¿‡`javac`ç¼–è¯‘åä½¿ç”¨åç¼–è¯‘å·¥å…·æŸ¥çœ‹:

```java
// Iterator EntrySetåç¼–è¯‘ç»“æœ
public static void iteratorEntrySet() {
    Iterator var0 = productMap.entrySet().iterator();
    while(var0.hasNext()) {
        Entry var1 = (Entry)var0.next();  // ä¸€æ¬¡è·å–é”®å€¼å¯¹
        System.out.println(var1.getKey());
        System.out.println((String)var1.getValue());
    }
}

// ForEach EntrySetåç¼–è¯‘ç»“æœ
public static void forEachEntrySet() {
    Iterator var0 = productMap.entrySet().iterator();
    while(var0.hasNext()) {
        Entry var1 = (Entry)var0.next();  // å®Œå…¨ç›¸åŒçš„å­—èŠ‚ç 
        System.out.println(var1.getKey());
        System.out.println((String)var1.getValue());
    }
}
```

**ç»“è®º**: Iteratorå’ŒForEachçš„EntrySetæ–¹å¼ç”Ÿæˆçš„å­—èŠ‚ç å®Œå…¨ä¸€è‡´,å› æ­¤æ€§èƒ½ç›¸åŒã€‚

### KeySetæ–¹å¼çš„æ€§èƒ½ç“¶é¢ˆ

```java
// Iterator KeySetåç¼–è¯‘ç»“æœ
public static void iteratorKeySet() {
    Iterator var0 = productMap.keySet().iterator();
    while(var0.hasNext()) {
        Integer var1 = (Integer)var0.next();
        System.out.println(var1);
        System.out.println((String)productMap.get(var1));  // äºŒæ¬¡æŸ¥è¯¢
    }
}
```

**æ€§èƒ½å·®è·åŸå› åˆ†æ:**

```mermaid
graph LR
    A[EntrySetæ–¹å¼] --> B[éå†1æ¬¡]
    B --> C[ç›´æ¥ä»Entryè·å–K/V]
    
    D[KeySetæ–¹å¼] --> E[éå†1æ¬¡è·å–Key]
    E --> F[å†æ¬¡getæŸ¥è¯¢Value]
    F --> G[å®é™…éå†2æ¬¡]
    
    style A fill:#50E3C2,color:#fff,rx:10,ry:10
    style C fill:#50E3C2,color:#fff,rx:10,ry:10
    style D fill:#E94B3C,color:#fff,rx:10,ry:10
    style G fill:#E94B3C,color:#fff,rx:10,ry:10
```

**EntrySetä¼˜åŠ¿:**
- éå†æ—¶ç›´æ¥åˆ›å»ºEntryå¯¹è±¡åŒ…å«keyå’Œvalue
- åç»­è®¿é—®æ— éœ€å†æ¬¡æŸ¥è¯¢,ç›´æ¥ä»Entryè·å–

**KeySetåŠ£åŠ¿:**
- ç¬¬ä¸€æ¬¡éå†è·å–key
- ç¬¬äºŒæ¬¡é€šè¿‡`map.get(key)`å†æ¬¡éå†æŸ¥è¯¢value
- ç›¸å½“äºåŒå€éå†å¼€é”€

## éå†ä¸­çš„å®‰å…¨æ“ä½œ

### ä¸å®‰å…¨æ“ä½œç¤ºä¾‹

#### åœºæ™¯1: è¿­ä»£å™¨ä¸­ç›´æ¥åˆ é™¤(âŒ å¼‚å¸¸)

```java
Iterator<Map.Entry<String, Integer>> iterator = inventory.entrySet().iterator();
while (iterator.hasNext()) {
    Map.Entry<String, Integer> entry = iterator.next();
    if (entry.getValue() < 100) {
        inventory.remove(entry.getKey());  // âŒ ConcurrentModificationException
    }
}
```

#### åœºæ™¯2: ForEachä¸­åˆ é™¤(âŒ å¼‚å¸¸)

```java
for (Map.Entry<String, Integer> entry : inventory.entrySet()) {
    if (entry.getValue() < 100) {
        inventory.remove(entry.getKey());  // âŒ ConcurrentModificationException
    }
}
```

#### åœºæ™¯3: Lambdaä¸­åˆ é™¤(âŒ å¼‚å¸¸)

```java
inventory.forEach((product, stock) -> {
    if (stock < 100) {
        inventory.remove(product);  // âŒ ConcurrentModificationException
    }
});
```

#### åœºæ™¯4: Streamä¸­åˆ é™¤(âŒ å¼‚å¸¸)

```java
inventory.entrySet().stream().forEach(entry -> {
    if (entry.getValue() < 100) {
        inventory.remove(entry.getKey());  // âŒ ConcurrentModificationException
    }
});
```

### å®‰å…¨æ“ä½œæ–¹æ¡ˆ

#### æ–¹æ¡ˆ1: ä½¿ç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•(âœ… æ¨è)

```java
public void safeRemoveWithIterator() {
    Map<String, Integer> inventory = new HashMap<>();
    inventory.put("iPhone-15", 120);
    inventory.put("MacBook-Pro", 85);
    inventory.put("AirPods-Pro", 55);
    
    Iterator<Map.Entry<String, Integer>> iterator = inventory.entrySet().iterator();
    while (iterator.hasNext()) {
        Map.Entry<String, Integer> entry = iterator.next();
        if (entry.getValue() < 100) {
            System.out.println("åˆ é™¤ä½åº“å­˜å•†å“: " + entry.getKey());
            iterator.remove();  // âœ… å®‰å…¨åˆ é™¤
        }
    }
    
    System.out.println("å‰©ä½™å•†å“: " + inventory);
}
```

**è¾“å‡ºç»“æœ:**
```
åˆ é™¤ä½åº“å­˜å•†å“: MacBook-Pro
åˆ é™¤ä½åº“å­˜å•†å“: AirPods-Pro
å‰©ä½™å•†å“: {iPhone-15=120}
```

#### æ–¹æ¡ˆ2: Lambdaçš„removeIfæ–¹æ³•(âœ… æ¨è)

```java
public void safeRemoveWithLambda() {
    Map<String, Integer> inventory = new HashMap<>();
    inventory.put("iPhone-15", 120);
    inventory.put("MacBook-Pro", 85);
    inventory.put("AirPods-Pro", 55);
    
    // å…ˆä½¿ç”¨removeIfåˆ é™¤ä½åº“å­˜å•†å“
    inventory.keySet().removeIf(product -> inventory.get(product) < 100);
    
    // å†éå†å‰©ä½™å•†å“
    inventory.forEach((product, stock) -> {
        System.out.println("å•†å“: " + product + ", åº“å­˜: " + stock);
    });
}
```

#### æ–¹æ¡ˆ3: Streamçš„filterè¿‡æ»¤(âœ… æ¨è)

```java
public Map<String, Integer> safeFilterWithStream() {
    Map<String, Integer> inventory = new HashMap<>();
    inventory.put("iPhone-15", 120);
    inventory.put("MacBook-Pro", 85);
    inventory.put("AirPods-Pro", 55);
    
    // è¿‡æ»¤å‡ºåº“å­˜>=100çš„å•†å“
    Map<String, Integer> filteredInventory = inventory.entrySet().stream()
            .filter(entry -> entry.getValue() >= 100)
            .collect(Collectors.toMap(
                Map.Entry::getKey,
                Map.Entry::getValue
            ));
    
    return filteredInventory;
}
```

#### æ–¹æ¡ˆ4: å…ˆæ”¶é›†å†åˆ é™¤(âœ… é€‚ç”¨å¤æ‚é€»è¾‘)

```java
public void collectThenRemove() {
    Map<String, Integer> inventory = new HashMap<>();
    inventory.put("iPhone-15", 120);
    inventory.put("MacBook-Pro", 85);
    inventory.put("AirPods-Pro", 55);
    
    // å…ˆæ”¶é›†éœ€è¦åˆ é™¤çš„key
    List<String> toRemove = new ArrayList<>();
    for (Map.Entry<String, Integer> entry : inventory.entrySet()) {
        if (entry.getValue() < 100) {
            toRemove.add(entry.getKey());
        }
    }
    
    // å†ç»Ÿä¸€åˆ é™¤
    toRemove.forEach(inventory::remove);
    
    System.out.println("å‰©ä½™å•†å“: " + inventory);
}
```

### å®‰å…¨æ€§å¯¹æ¯”æ€»ç»“

| æ“ä½œæ–¹å¼ | æ˜¯å¦å®‰å…¨ | æ¨èæŒ‡æ•° | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|---------|
| Iterator.remove() | âœ… | â­â­â­â­â­ | éå†æ—¶ç®€å•åˆ é™¤ |
| KeySet.removeIf() | âœ… | â­â­â­â­â­ | Lambdaé£æ ¼åˆ é™¤ |
| Stream.filter() | âœ… | â­â­â­â­ | éœ€è¦è¿”å›æ–°é›†åˆ |
| å…ˆæ”¶é›†å†åˆ é™¤ | âœ… | â­â­â­ | å¤æ‚åˆ é™¤é€»è¾‘ |
| ForEachä¸­map.remove() | âŒ | - | ç¦æ­¢ä½¿ç”¨ |
| Lambdaä¸­map.remove() | âŒ | - | ç¦æ­¢ä½¿ç”¨ |
| Streamä¸­map.remove() | âŒ | - | ç¦æ­¢ä½¿ç”¨ |

## æœ€ä½³å®è·µå»ºè®®

### é€‰æ‹©å†³ç­–æ ‘

```mermaid
graph TD
    A[éœ€è¦éå†HashMap] --> B{éœ€è¦åˆ é™¤å…ƒç´ ?}
    B -->|æ˜¯| C{åˆ é™¤é€»è¾‘å¤æ‚?}
    B -->|å¦| D{éœ€è¦é«˜æ€§èƒ½?}
    
    C -->|æ˜¯| E[ä½¿ç”¨å…ˆæ”¶é›†å†åˆ é™¤]
    C -->|å¦| F{å–œæ¬¢å‡½æ•°å¼ç¼–ç¨‹?}
    
    F -->|æ˜¯| G[ä½¿ç”¨removeIfæˆ–filter]
    F -->|å¦| H[ä½¿ç”¨Iterator.remove]
    
    D -->|æ˜¯| I{éœ€è¦keyå’Œvalue?}
    D -->|å¦| J[ä½¿ç”¨Lambdaæˆ–Stream]
    
    I -->|æ˜¯| K[ä½¿ç”¨EntrySetéå†]
    I -->|å¦| L[å¯ä½¿ç”¨KeySet]
    
    style A fill:#4A90E2,color:#fff,rx:10,ry:10
    style K fill:#50E3C2,color:#fff,rx:10,ry:10
    style G fill:#50E3C2,color:#fff,rx:10,ry:10
    style H fill:#50E3C2,color:#fff,rx:10,ry:10
```

### æ ¸å¿ƒåŸåˆ™

1. **ä¼˜å…ˆä½¿ç”¨EntrySetè€ŒéKeySet** - æ€§èƒ½æå‡1.8å€
2. **åˆ é™¤æ“ä½œå¿…é¡»ä½¿ç”¨å®‰å…¨æ–¹å¼** - é¿å…ConcurrentModificationException
3. **ç®€å•åœºæ™¯ä¼˜å…ˆLambda/Stream** - ä»£ç ç®€æ´æ˜“è¯»
4. **å¤§æ•°æ®é‡è€ƒè™‘å¹¶è¡ŒStream** - å……åˆ†åˆ©ç”¨å¤šæ ¸CPU
5. **æ€§èƒ½æ•æ„Ÿåœºæ™¯ä½¿ç”¨Iterator** - æœ€å°å¼€é”€

### å®æˆ˜ä»£ç ç¤ºä¾‹

**åœºæ™¯: ç”µå•†ä¿ƒé”€æ´»åŠ¨-è‡ªåŠ¨ä¸‹æ¶ä½åº“å­˜å•†å“**

```java
public class PromotionManager {
    private Map<String, ProductInfo> products;
    
    // æ¨èæ–¹å¼1: Lambda removeIf
    public void removeOutOfStock() {
        products.keySet().removeIf(productId -> 
            products.get(productId).getStock() < 10
        );
    }
    
    // æ¨èæ–¹å¼2: Stream filter
    public Map<String, ProductInfo> getAvailableProducts() {
        return products.entrySet().stream()
                .filter(entry -> entry.getValue().getStock() >= 10)
                .collect(Collectors.toMap(
                    Map.Entry::getKey,
                    Map.Entry::getValue
                ));
    }
    
    // æ¨èæ–¹å¼3: Iterator remove
    public void removeWithLog() {
        Iterator<Map.Entry<String, ProductInfo>> iterator = 
            products.entrySet().iterator();
        
        while (iterator.hasNext()) {
            Map.Entry<String, ProductInfo> entry = iterator.next();
            if (entry.getValue().getStock() < 10) {
                System.out.println("ä¸‹æ¶å•†å“: " + entry.getKey());
                iterator.remove();
            }
        }
    }
    
    static class ProductInfo {
        private int stock;
        public int getStock() { return stock; }
    }
}
```

é€šè¿‡åˆç†é€‰æ‹©éå†æ–¹å¼,å¯ä»¥åœ¨ä¿è¯ä»£ç å®‰å…¨æ€§çš„åŒæ—¶,è·å¾—æœ€ä½³çš„æ‰§è¡Œæ€§èƒ½ã€‚
